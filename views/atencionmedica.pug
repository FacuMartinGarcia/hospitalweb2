extends layout

block content

  style.
    .seccion {
      padding: 1.5rem;
      border-radius: 10px;
      margin-bottom: 2rem;
    }
    .seccion-1 {
      background-color: #f0f4f8;
    }
    .seccion-2 {
      background-color: #e8f0ff;
    }
    .titulo-seccion {
      text-align: center;
      font-weight: bold;
      font-size: 1.2rem;
      margin-bottom: 1rem;
    }
    .table th {
      background-color: rgb(41, 108, 175); 
      color: #f8f9fa;
      font-weight: bold;
      border: 1px solid rgb(41, 108, 175);
      text-align: center;
    }
    .table tbody td {
      border: 1px solid #dee2e6;
    }
    .navegacion-secciones {
      background-color: #f5e9ff;
      border: 1px solid #ccc;
      border-radius: 10px;
    }
    #mensajes {
      border-radius: 6px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    .secciones-container {
      background-color: #fdfdfe;
      padding: 2rem;
      border-radius: 12px;
      margin-bottom: 3rem;
    }
    .col-fecha {
      width: 10%;
      text-align: center;
    }

    .col-medico {
      width: 25%;
      text-align: center;
    }

    .col-cantidad {
      width: 5%;
      text-align: center;
    }

    .col-medicamento {
      width: 30%;
    }

    .col-observaciones {
      width: 30%;
    }

    .form-label {
      font-weight: 500;
      margin-bottom: 0.3rem;
      color: #495057;
    }

    textarea.form-control {
      min-height: 38px;
      resize: vertical;
    }

    .form-select {
      cursor: pointer;
    }

    .form-label {
      font-weight: 500;
      margin-bottom: 0.5rem;
      display: block;
    }

    .btn-registrar {
      min-width: 180px;
      padding: 0.5rem 1.5rem;
      font-weight: 500;
    }

    .mb-3 {
      margin-bottom: 1.2rem !important;
    }

    .mb-4 {
      margin-bottom: 1.8rem !important;
    }


  .card.shadow.mb-4
    .card-body
      h2.text-center.h5.mb-4 Registros de atención médica durante la Internación

      include componentes/_busquedaPaciente.pug
      #datosInternacion

  .card.shadow.secciones-container(style="display: none;" id="contenedorAtencionMedica")
    .card-body

      // CARD 1: Médico y fecha
      .mb-4
        .row
          .col-md-12
            label.fw-bold.mb-1 Médico:
            select.form-select#medicoSesion
              option(value="") Seleccione médico

      // CARD 2: Botones de navegación
      .mb-4.navegacion-secciones
        .card-body
          .row.justify-content-center.g-3
            each seccion, index in ['evaluaciones', 'medicamentos', 'estudios', 'cirugias', 'terapias']
              .col-md-2.col-sm-4.col-6
                button.btn.btn-outline-primary.w-100(
                  type="button", 
                  data-seccion=seccion
                )= seccion.charAt(0).toUpperCase() + seccion.slice(1)
      // Mensajes y scripts
      #mensajesSeccion.mt-3.text-center            


      // 1. Evaluaciones
      form.seccion.seccion-1#evaluaciones
        h3.titulo-seccion Evaluaciones
        .row.mb-2
          .col-md-12
            select.form-select#diagnosticoEvaluacion
              option(value="") Seleccione diagnóstico
        .row.mb-2
          .col-md-12
            input.form-control(type="text", placeholder="Observaciones", id="observacionesEvaluacion")
        .text-end.mb-2
          button.btn.btn-success#btnRegistrarEvaluacion(type="submit") Registrar Evaluación
        table.table.table-bordered.table-sm.tabla
          thead
            tr
              th Fecha
              th Médico
              th Diagnóstico
              th Observaciones
              th Acciones
          tbody#tablaEvaluaciones

      // 2. Medicamentos
      form.seccion.seccion-2#medicamentos
        h3.titulo-seccion.mb-3 Medicamentos
        .row.mb-2
          .col-md-6
            label.form-label.text-center.w-100(for="medicamentoPrescripcion") Medicamento:
            select.form-select#medicamentoPrescripcion
              option(value="") Seleccione medicamento
          .col-md-2
            label.form-label.text-center.w-100(for="cantidadPrescripcion") Cantidad:
            input.form-control(type="number", id="cantidadPrescripcion", min="1")
          .col-md-4
            label.form-label.text-center.w-100(for="observacionesPrescripcion") Observaciones:
            input.form-control(type="text", id="observacionesPrescripcion", style="text-transform: uppercase;")

        .text-end.mb-3
          button.btn.btn-success.btn-registrar#btnRegistrarPrescripcion(type="submit") Registrar Medicamento
        table.table.table-bordered.table-sm.tabla
          thead
            tr
              th(class="text-center col-fecha") Fecha
              th(class="col-medico") Médico
              th(class="col-medicamento") Medicamento
              th(class="text-center col-cantidad") Cantidad 
              th(class="col-observaciones") Observaciones
          tbody#tablaMedicamentos

      // 3. Estudios 
      form.seccion.seccion-1#estudios
        h3.titulo-seccion.mb-4 Estudios / Análisis 
        .row.mb-3
          .col-md-4
            label.form-label.text-center.w-100(for="tipoEstudio") Tipo de estudio:
            select.form-select#tipoEstudio
              option(value="") Seleccione tipo de estudio
          .col-md-8
            label.form-label.text-center.w-100(for="observacionesEstudios") Observaciones:
            input.form-control(type="text", id="observacionesEstudios", style="text-transform: uppercase;")

        .row.mb-4
          .col-12
            .d-flex.justify-content-end
              button.btn.btn-success.btn-registrar#btnRegistrarEstudio(type="submit") Registrar Estudio
        
        table.table.table-bordered.table-sm.tabla
          thead
            tr
              th(class="text-center col-fecha") Fecha
              th(class="col-medico") Médico
              th Tipo de Estudio
              th(class="col-observaciones") Observaciones
          tbody#tablaEstudios

      // 4. Cirugías
      form.seccion.seccion-2#cirugias
        h3.titulo-seccion.mb-4 Cirugías
        .row.mb-3
          .col-md-6
            label.form-label.text-center.w-100(for="tipoCirugia") Tipo de cirugía:
            select.form-select#tipoCirugia
              option(value="") Seleccione tipo de cirugía
          .col-md-6
            label.form-label.text-center.w-100(for="tipoAnestesia") Tipo de anestesia:
            select.form-select#tipoAnestesia
              option(value="") Seleccione tipo de anestesia

        .row.mb-3
          .col-md-12
            label.form-label.text-center.w-100(for="observacionesCirugia") Observaciones:
            textarea.form-control(id="observacionesCirugia", rows="2", style="text-transform: uppercase;")

        .row.mb-4
          .col-12
            .d-flex.justify-content-end
              button.btn.btn-success.btn-registrar#btnRegistrarCirugia(type="submit") Registrar Cirugía
        
        table.table.table-bordered.table-sm.tabla
          thead
            tr
              th(class="text-center col-fecha") Fecha
              th(class="col-medico") Médico
              th Tipo de Cirugía
              th Tipo de Anestesia
              th(class="col-observaciones") Observaciones
          tbody#tablaCirugias

      // 5. Terapias
      form.seccion.seccion-1#terapias
        h3.titulo-seccion.mb-4 Terapias
        .row.mb-3
          .col-md-4
            label.form-label.text-center.w-100(for="tipoTerapia") Tipo de terapia:
            select.form-select#tipoTerapia
              option(value="") Seleccione tipo de terapia
          .col-md-8
            label.form-label.text-center.w-100(for="observacionesTerapia") Observaciones:
            textarea.form-control(id="observacionesTerapia", rows="2", style="text-transform: uppercase;")

        .row.mb-4
          .col-12
            .d-flex.justify-content-end
              button.btn.btn-success.btn-registrar#btnRegistrarTerapia(type="submit") Registrar Terapia
        
        table.table.table-bordered.table-sm.tabla
          thead
            tr
              th(class="text-center col-fecha") Fecha Solicitud
              th(class="col-medico") Médico
              th Tipo de Terapia
              th(class="col-observaciones") Observaciones
              th(class="text-center col-acciones") Acciones
          tbody#tablaTerapias

  script(src="https://cdn.jsdelivr.net/npm/sweetalert2@11")
  script(type="module", src="/js/atencionmedica.js")

  script.
    document.addEventListener('DOMContentLoaded', () => {
      const botones = document.querySelectorAll('button[data-seccion]');
      const secciones = ['evaluaciones', 'medicamentos', 'estudios', 'cirugias', 'terapias'];

      function mostrarSeccion(id) {
        secciones.forEach(s => {
          const el = document.getElementById(s);
          if (el) el.style.display = (s === id) ? 'block' : 'none';
        });
      }

      botones.forEach(btn => {
        btn.addEventListener('click', () => {
          mostrarSeccion(btn.dataset.seccion);
        });
      });

      mostrarSeccion('evaluaciones');
    });
